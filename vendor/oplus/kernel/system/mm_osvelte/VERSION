67917c7dec6a sync code & fix coverity
